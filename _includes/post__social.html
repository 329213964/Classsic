<div class="post__social">
  {% if page.comments == true %}
    <button onclick="load_disqus()" id="js-comment-btn" class="btn"><svg class="icon"><use xlink:href="#icon-comments"></use></svg> <span class="disqus-comment-count comments-link" data-disqus-url="{{ site.url }}{{ page.url }}">Leave a Comment</span></button>
  {% endif %}

  {% if page.share != empty and page.share != false %}
    <a class="btn btn--twitter" href="https://twitter.com/share?url={{ page.url | replace:'index.html','' | prepend: site.url | uri_escape }}&via={{ site.owner.twitter }}&text={{ page.title | markdownify | remove: '<p>' | remove: '</p>' | cgi_escape }}" target="_blank" title="Share on Twitter"><svg class="icon"><use xlink:href="#icon-twitter"></use></svg> Tweet</a>
    <a class="btn btn--facebook" href="https://www.facebook.com/sharer/sharer.php?u={{ page.url | replace:'index.html','' | prepend: site.url | uri_escape }}" target="_blank" title="Share on Facebook"><svg class="icon"><use xlink:href="#icon-facebook"></use></svg> Share</a>
  {% endif %}
</div>

{% if page.comments == true %}
  <section class="post__comments">
    {% if site.repository and site.staticman.branch %}
      <!-- Start static comments -->
      {% if site.data.comments[page.slug] %}
        <h4 class="page__comments-title">Comments</h4>
        {% assign comments = site.data.comments[page.slug] | sort %}

        {% for comment in comments %}
          {% assign avatar = comment[1].avatar %}
          {% assign email = comment[1].email %}
          {% assign name = comment[1].name %}
          {% assign url = comment[1].url %}
          {% assign date = comment[1].date %}
          {% assign message = comment[1].message %}
          {% include comment.html index=forloop.index avatar=avatar email=email name=name url=url date=date message=message %}
        {% endfor %}
      {% endif %}
      <!-- End static comments -->

      <!-- Start new comment form -->
      <h4 class="page__comments-title">Leave a Comment</h4>
      <p class="small">Your email address will not be published. Required fields are marked <span class="required">*</span></p>
      <form id="new_comment" class="page__comments-form js-form form" method="post" action="https://api.staticman.net/v1/entry/{{ site.repository }}/{{ site.staticman.branch }}">
        <div class="form__spinner">
          <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
          <span class="sr-only">Loading...</span>
        </div>

        <fieldset>
          <label for="comment-form-message">Comment <small class="required">*</small></label>
          <textarea type="text" rows="3" id="comment-form-message" name="fields[message]" tabindex="1"></textarea>
          <div class="small help-block"><a href="https://daringfireball.net/projects/markdown/">Markdown is supported.</a></div>
        </fieldset>
        <fieldset>
          <label for="comment-form-name">Name <small class="required">*</small></label>
          <input type="text" id="comment-form-name" name="fields[name]" tabindex="2" />
        </fieldset>
        <fieldset>
          <label for="comment-form-email">Email address <small class="required">*</small></label>
          <input type="email" id="comment-form-email" name="fields[email]" tabindex="3" />
        </fieldset>
        <fieldset>
          <label for="comment-form-url">Website (optional)</label>
          <input type="url" id="comment-form-url" name="fields[url]" tabindex="4"/>
        </fieldset>
        <fieldset class="hidden">
          <input type="hidden" name="options[slug]" value="{{ page.slug }}">
          <input type="hidden" name="fields[hidden]"/>
        </fieldset>
        <!-- Start comment form alert messaging -->
        <p class="hidden js-notice">
          <strong class="js-notice-text"></strong>
        </p>
        <!-- End comment form alert messaging -->
        <fieldset>
          <button type="submit" id="comment-form-submit" tabindex="5" class="btn btn--large">Submit Comment</button>
        </fieldset>
      </form>
      <!-- End new comment form -->
    {% endif %}

    <!-- <noscript><p>Please enable JavaScript to view the the comments.</p></noscript> -->
    <!-- <div id="disqus_loader">
      <script async>
        var disqus_shortname = "{{ site.disqus-shortname }}";
        var disqus_title = "{{ page.title | xml_escape }}";
        var disqus_url = "{{ page.url | replace:"index.html","" | prepend: site.url }}";

        function load_disqus(){
          document.getElementById("js-comment-btn").classList.add("btn--disabled");
          var dsq = document.createElement("script");
          dsq.type = "text/javascript";
          dsq.async = true;
          dsq.src = "https://" + disqus_shortname + ".disqus.com/embed.js";
          (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
        }
      </script>
    </div> -->
  </section>
{% endif %}
